<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="local/extcsv/db" VERSION="20240101" COMMENT="XMLDB file for Moodle local/extcsv"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd"
>
  <TABLES>
    <TABLE NAME="local_extcsv_sources" COMMENT="CSV data sources">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="name" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false"/>
        <FIELD NAME="description" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="status" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="disabled" SEQUENCE="false" COMMENT="enabled, disabled, frozen"/>
        <FIELD NAME="url" TYPE="text" NOTNULL="true" SEQUENCE="false" COMMENT="Source URL or Google Sheets export URL"/>
        <FIELD NAME="content_type" TYPE="char" LENGTH="10" NOTNULL="true" DEFAULT="csv" SEQUENCE="false" COMMENT="csv or tsv"/>
        <FIELD NAME="schedule" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Cron expression for updates"/>
        <FIELD NAME="columns_config" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="JSON configuration of column mappings"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="lastupdate" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="Timestamp of last update attempt"/>
        <FIELD NAME="lastupdatestatus" TYPE="char" LENGTH="20" NOTNULL="false" SEQUENCE="false" COMMENT="success, error, pending"/>
        <FIELD NAME="lastupdateerror" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Error message if last update failed"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="status" UNIQUE="false" FIELDS="status"/>
      </INDEXES>
    </TABLE>

    <TABLE NAME="local_extcsv_data" COMMENT="CSV row data">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="sourceid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Reference to local_extcsv_sources.id"/>
        <FIELD NAME="rownum" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Row number from CSV source"/>
        <FIELD NAME="text1" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text2" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text3" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text4" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text5" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text6" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text7" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text8" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text9" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text10" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text11" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text12" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text13" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text14" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text15" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text16" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text17" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text18" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text19" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text20" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int1" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int2" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int3" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int4" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int5" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int6" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int7" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int8" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int9" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int10" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int11" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int12" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int13" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int14" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int15" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int16" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int17" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int18" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int19" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int20" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float1" TYPE="number" LENGTH="20,10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float2" TYPE="number" LENGTH="20,10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float3" TYPE="number" LENGTH="20,10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float4" TYPE="number" LENGTH="20,10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float5" TYPE="number" LENGTH="20,10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="bool1" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="bool2" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="bool3" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="bool4" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="bool5" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date1" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date2" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date3" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date4" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date5" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date6" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date7" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date8" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date9" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date10" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="json1" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="json2" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="json3" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="sourceid" TYPE="foreign" FIELDS="sourceid" REFTABLE="local_extcsv_sources" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="sourceid" UNIQUE="false" FIELDS="sourceid"/>
        <INDEX NAME="sourceid_rownum" UNIQUE="true" FIELDS="sourceid,rownum"/>
      </INDEXES>
    </TABLE>
  </TABLES>
</XMLDB>

