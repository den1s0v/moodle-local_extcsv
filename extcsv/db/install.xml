<?xml version="1.0" encoding="UTF-8" ?>
<XMLDB PATH="local/extcsv/db" VERSION="20240101" COMMENT="XMLDB file for Moodle local/extcsv"
    xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance"
    xsi:noNamespaceSchemaLocation="../../../lib/xmldb/xmldb.xsd"
>
  <TABLES>
    <TABLE NAME="local_extcsv_sources" COMMENT="CSV data sources">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="name" TYPE="char" LENGTH="255" NOTNULL="true" SEQUENCE="false"/>
        <FIELD NAME="shortname" TYPE="char" LENGTH="100" NOTNULL="false" SEQUENCE="false" COMMENT="Short machine-readable name for integrations"/>
        <FIELD NAME="description" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="status" TYPE="char" LENGTH="20" NOTNULL="true" DEFAULT="disabled" SEQUENCE="false" COMMENT="enabled, disabled, frozen"/>
        <FIELD NAME="url" TYPE="text" NOTNULL="true" SEQUENCE="false" COMMENT="Source URL or Google Sheets export URL"/>
        <FIELD NAME="content_type" TYPE="char" LENGTH="10" NOTNULL="true" DEFAULT="csv" SEQUENCE="false" COMMENT="csv or tsv"/>
        <FIELD NAME="schedule" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Cron expression for updates"/>
        <FIELD NAME="columns_config" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="JSON configuration of column mappings"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="timemodified" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="lastupdate" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false" COMMENT="Timestamp of last update attempt"/>
        <FIELD NAME="lastupdatestatus" TYPE="char" LENGTH="20" NOTNULL="false" SEQUENCE="false" COMMENT="success, error, pending"/>
        <FIELD NAME="lastupdateerror" TYPE="text" NOTNULL="false" SEQUENCE="false" COMMENT="Error message if last update failed"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="status" UNIQUE="false" FIELDS="status"/>
      </INDEXES>
    </TABLE>

    <TABLE NAME="local_extcsv_data" COMMENT="CSV row data">
      <FIELDS>
        <FIELD NAME="id" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="true"/>
        <FIELD NAME="sourceid" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Reference to local_extcsv_sources.id"/>
        <FIELD NAME="rownum" TYPE="int" LENGTH="10" NOTNULL="true" SEQUENCE="false" COMMENT="Row number from CSV source"/>
        <FIELD NAME="text_1" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_2" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_3" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_4" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_5" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_6" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_7" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_8" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_9" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_10" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_11" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_12" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_13" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_14" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_15" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_16" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_17" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_18" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_19" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="text_20" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_1" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_2" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_3" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_4" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_5" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_6" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_7" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_8" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_9" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_10" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_11" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_12" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_13" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_14" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_15" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_16" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_17" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_18" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_19" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="int_20" TYPE="int" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float_1" TYPE="number" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float_2" TYPE="number" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float_3" TYPE="number" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float_4" TYPE="number" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="float_5" TYPE="number" LENGTH="10" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="bool_1" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="bool_2" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="bool_3" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="bool_4" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="bool_5" TYPE="int" LENGTH="1" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_1" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_2" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_3" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_4" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_5" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_6" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_7" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_8" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_9" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="date_10" TYPE="int" LENGTH="10" NOTNULL="false" DEFAULT="0" SEQUENCE="false"/>
        <FIELD NAME="json_1" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="json_2" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="json_3" TYPE="text" NOTNULL="false" SEQUENCE="false"/>
        <FIELD NAME="timecreated" TYPE="int" LENGTH="10" NOTNULL="true" DEFAULT="0" SEQUENCE="false"/>
      </FIELDS>
      <KEYS>
        <KEY NAME="primary" TYPE="primary" FIELDS="id"/>
        <KEY NAME="sourceid" TYPE="foreign" FIELDS="sourceid" REFTABLE="local_extcsv_sources" REFFIELDS="id"/>
      </KEYS>
      <INDEXES>
        <INDEX NAME="sourceid" UNIQUE="false" FIELDS="sourceid"/>
        <INDEX NAME="sourceid_rownum" UNIQUE="true" FIELDS="sourceid,rownum"/>
      </INDEXES>
    </TABLE>
  </TABLES>
</XMLDB>

